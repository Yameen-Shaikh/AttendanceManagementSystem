{% extends 'base_student.html' %}

{% block title %}My Dashboard{% endblock %}

{% block content_wrapper %}
<div class="main-content student-dashboard-content mt-4">
    {% block content %}
        {% for enrollment in enrollments %}
            <div class="card mb-3">
                <h1 class="mb-4">My Enrolled Courses</h1>
                <h2 class="h5">{{ enrollment.class_obj.course.name }}</h2>
                <p class="mb-2">Attendance: <strong>{{ enrollment.attendance_percentage }}%</strong></p>
                <div class="progress-bar">
                    <div class="progress" data-progress="{{ enrollment.attendance_percentage|default:0 }}"></div>
                </div>
                <a href="{% url 'student:scan_qr_code' enrollment.class_obj.id %}" class="btn-grad mt-3">Mark Today's Attendance</a>
            </div>
        {% empty %}
            <div class="card">
                <p>You are not enrolled in any courses yet.</p>
            </div>
        {% endfor %}
    {% endblock content %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const progressBars = document.querySelectorAll('.progress');
        progressBars.forEach(bar => {
            const percentage = bar.dataset.progress;
            bar.style.width = percentage + '%';
        });
    });
</script>
</div>
{% endblock %}